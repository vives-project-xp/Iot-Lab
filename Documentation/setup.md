# Opzetten van de home assistant

Ten eerste plug je de home assitant en CDEM in. Hierbij moet de CDEM verbonden zijn met de digitale meter.
Indien de CDEM nog meer setup nodig heeft zie de [documentatie Dag_Van_De_Wetenschap](./Dag_Van_De_Wetenschap.md).

Belangrijk is dat je het IP van de home assistant moet aanpassen. Zie hiervoor [documentatie IP adressen](./NetwerkIP.md.).

Hierna kan je de schermen instellen, hiervoor heb je een extra pi nodig. Op deze pi verbind je met de home assistant en kan je dan de verschillende dashboards tonen, het webadres is hier dan [hassIP]:8123. De mogelijke gebruikers zijn iot en watcher. De wachtwoorden hiervan zijn te vinden aan de hand van de password manager.
Op deze pi wordt ook het gescript gebruikt die de voeding aanstuurt om de dag te simuleren. Hiervoor moeten eerst de voeding en de inverter aanstaan. Steek de voeding in, maar niet in het net van de digitale meter en verbind hem vervolgens met de inverter. Steek de inverter in in het net van de digitale meter en verbind de USB van de voeding met de pi. Voer vervolgens op de pi het powersupply script uit met python3 mqtt.py. Het script is te vinden in de directory /Documents/powersupply_final/Iot_Lab_Powersupply_Script/ Bij het runnen van dit script moet je zeker maken dat het ip address van de mqtt broker juist ingesteld is en de poort waarop de voeding aangesloten is ook juist staat. Dit kan gedaan worden aan de hand van nano. Voor meer info zie [Powersupply repo documentatie](https://github.com/vives-project-xp/Iot-lab_powersupply_script).

Voor de opstelling moet je vervolgens de verschillende bouwlampen/toestellen verbinden die we gebruiken om te simuleren. In onze opstelling zijn de verschillende plugs gelabeled met het toestel waarmee verbonden wordt. De koelkast is het toestel dat het minste verbruikt, dan de oven en dan de boiler. Om de oven en boiler aan te sturen worden de buttons gebruikt waarop oven en boiler staan. Indien je meldingen wilt ontvangen bij het drukken van de knoppen is het nodig dat je je gsm toe voegt aan home assistant en je apparaat in configuration.yaml toevoegt aan ALL_DEVICES. Indien dit toch niet werkt kan het nodig zijn dat je de automatie die de melding stuurt aanpast.

Vervolgens moet je de twee cameras aan zetten waarop a306 en a308 staat, de fibaro motion sensor aanzetten waarop motion staat, de door sensor aanzetten waarop door staat en de twee weather sensors waarop lumi 1 en lumi 2 staan. Indien de camera's nog niet op het juiste netwerk staan moet je deze opnieuw toevoegen op de eWeLink, dit hebben wij telkens gedaan aan de hand van geluidskoppeling. Voor het toevoegen op home assistant zie [configuratie devices](./config_smart_devices.md). Indien je de camera's opnieuw toevoegd moet op de frontend de live feed aangepast worden naar de nieuwe camera.

Gelieve ons te contacteren via lukas.hoste@student.vives.be of hoste324@gmail.com wanneer je tijdens de setup wachtwoorden nodig hebt, dan krijg je logingegevens voor bitwarden. Ook indien je nog meer vragen hebt over de setup kan je hiermee ons contacteren.
